
{% extends "layout.html" %}

{% macro _location(params) %}
<p class="govuk-body">
  We've matched the postcode <span class="govuk-!-font-weight-bold">{{ params.postcode | upper }}</span> to <span class="govuk-!-font-weight-bold">{{ params.placeName }}</span>.
</p>
{% endmacro %}

{% macro _guidanceLink(params) %}
<p class="govuk-body">
  <a class="govuk-link" href="{{ params.href }}">{{ params.text }}</a>
</p>
{% endmacro %}

{% block pageTitle %}
  {{ serviceName }}
{% endblock %}

{% block beforeContent %}
  {% include "includes/phase-banner.html" %}
  {{ govukBackLink({
    text: "Back",
    href: "/"
  }) }}
{% endblock %}

{% block content %}

  {% set commingSoon = date | date('YYYY-MM-DD') | dateDiff(restriction.start_date, 'days') %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      <h1 class="govuk-heading-xl">
        {%- if location.country in ['Scotland','Wales','Northern Ireland'] %}
          There might be restrictions in this area
        {% else %}
          {% if commingSoon %}
            The local alert level is changing soon
          {% else %}
            {%- if location | length %}
              {%- if restriction.alert_level %}
                Local alert level {{ restriction.alert_level }}
              {% else %}
                Local alert level 1
              {% endif -%}
            {% else %}
              There is no information about the restrictions in this area
            {% endif -%}
          {% endif -%}
        {% endif -%}
      </h1>

      {%- if location.country === 'Scotland' %}

        {%- if location.district | length %}
          {{ _location({
            postcode: data.postcode,
            placeName: location.district
          }) }}
        {% endif -%}

        {{ _guidanceLink({
          href: 'https://www.gov.scot/coronavirus-covid-19/',
          text: 'Find out what you can or cannot do from the Scottish Government.'
        }) }}

      {% elif location.country === 'Wales' %}

        {%- if location.district | length %}
          {{ _location({
            postcode: data.postcode,
            placeName: location.district
          }) }}
        {% endif -%}

        {{ _guidanceLink({
          href: 'https://gov.wales/local-lockdown',
          text: 'Find out what you can or cannot do from the Welsh Government.'
        }) }}

      {% elif location.country === 'Northern Ireland' %}

        {%- if location.district | length %}
          {{ _location({
            postcode: data.postcode,
            placeName: location.district
          }) }}
        {% endif -%}

        {{ _guidanceLink({
          href: 'https://www.nidirect.gov.uk/articles/coronavirus-covid-19-regulations-and-localised-restrictions',
          text: 'Find out what you can or cannot do from the Northern Ireland Government.'
        }) }}

      {% else -%}

        {%- if location.district | length %}
          {{ _location({
            postcode: data.postcode,
            placeName: location.district
          }) }}
        {% endif -%}

        {% if commingSoon %}
          <p class="govuk-body">
            At the moment this area is in local alert level {{ (restriction.alert_level - 1) if restriction.alert_level else '1' }}.
          </p>
        {% else %}
          {%- if location | length %}
            <p class="govuk-body">
              This area is in local alert level {{ restriction.alert_level if restriction.alert_level else '1' }}.
            </p>
          {% endif -%}
        {% endif -%}

        {%- if location | length %}
          {%- if restriction.alert_level %}
            {{ _guidanceLink({
              href: 'https://www.gov.uk/' + restriction.guidance.link,
              text: 'What you can and cannot do.'
            }) }}
          {% else %}
            {{ _guidanceLink({
              href: 'https://www.gov.uk/government/collections/local-restrictions-areas-with-an-outbreak-of-coronavirus-covid-19',
              text: 'What you can and cannot do.'
            }) }}
          {% endif -%}
        {% else %}
          {{ _guidanceLink({
            href: 'https://www.gov.uk/government/collections/local-restrictions-areas-with-an-outbreak-of-coronavirus-covid-19',
            text: 'All coronavirus infomation about what you can and cannot do.'
          }) }}
        {% endif -%}

      {% endif -%}

      <h2 class="govuk-heading-m">
        If you travel to other areas {{- ' in England' if location.country in ['Scotland','Wales','Northern Ireland'] }}
      </h2>

      <p class="govuk-body">
        <a class="govuk-link" href="/">Enter another postcode</a> to find out what restrictions there are.
      </p>

    </div>
    <div class="govuk-grid-column-one-third">
      {% include "includes/related-navigation.html" %}
    </div>
  </div>

{% endblock %}
